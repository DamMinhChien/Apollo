<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Website</title>
    <link rel="icon" href="./assets/images/logo/favicon.png">
    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/bootstrap-icons-1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="./assets/css/animate.min.css">
    <link rel="stylesheet" href="./assets/css/owl.carousel.min.css">
    <script src="./assets/js/colorMap.js"></script>
    <script src="./assets/js/jquery.min.js"></script>
    <link rel="stylesheet" href="./assets/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="./assets/css/style.css">
    <style>
        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            background-color: transparent;
            filter: invert(1) grayscale(100%) sepia(100%) saturate(200%) hue-rotate(180deg);
        }
    </style>
</head>

<script>
    $(function () {
        $("header").load("navbar.html")
        $("footer").load("footer.html")
        $(".footer-bottom").load("footer-bottom.html")
        $("#progress").click(function () {
            $("html, body").animate({ scrollTop: 0 }, 10);
        })
            >
            $(document).ready(function () {
                let hours = 24, minutes = 0, seconds = 0;

                // Hàm cập nhật hiển thị thời gian
                function updateDisplay() {
                    $('#countdown').text(
                        `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`
                    );
                }

                // Hàm đếm ngược
                const countdownInterval = setInterval(function () {
                    seconds--;
                    if (seconds < 0) {
                        seconds = 59;
                        minutes--;
                    }
                    if (minutes < 0) {
                        minutes = 59;
                        hours--;
                    }

                    updateDisplay();

                    // Dừng đếm ngược khi thời gian còn lại là 0:0:0
                    if (hours <= 0 && minutes <= 0 && seconds <= 0) {
                        clearInterval(countdownInterval);
                        $('#countdown').text("Hết thời gian!");
                    }
                }, 1000); // Cập nhật mỗi giây (1000ms = 1 giây)
            });
        ShowNavbarWhenScroll()
        zoom()
        $(".pagination .page-item").click(function (e) {
            e.preventDefault()
            $(".pagination .page-item").removeClass("active")
            $(this).addClass("active")
        })

        let cards = []
        $.ajax({
            url: "./assets/data/products.json",
            type: "GET",
            dataType: "json",
            success: function (data) {
                cards = data
                renderCards(cards)
                zoom()
            },
            error: function (xhr, status, error) {
                $("body").prepend(`<div class="alert alert-warning alert-dismissible fade show" role="alert">
                    <strong>Lỗi: </strong> ${error}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>`)
            }
        })
    })
    function ShowNavbarWhenScroll() {
        var previousScroll = 0
        $(window).scroll(function () {
            var currentScroll = $(this).scrollTop();
            if (currentScroll > previousScroll) {
                $('.navbar').stop().slideUp(1000, "linear");
            } else {
                $('.navbar').stop().slideDown(100, "linear");
            }
            previousScroll = currentScroll;
        })
    }
    function renderCards(cards) {
        let cardList = $("#card-list");
        cardList.empty();

        // Khởi tạo Owl Carousel với các cấu hình mong muốn
        cardList.addClass("owl-carousel owl-theme");

        cards.forEach((card, index) => {
            let cardHTML = `
            <div class="item">
                <div class="card">
                    <a href="#" class="overflow-hidden"><img id="product-image-${card.id}" src="${card.versions[0].img_path}" alt="img" class="card-img-top"></a>
                    <div class="card-body">
                        <h5 class="card-title fw-normal">${card.title}</h5>
                        <p class="card-text fw-bold">${card.versions[0].price}</p>
                        <div id="color-options-${card.id}" class="d-flex gap-2 align-content-center flex-wrap">
                        </div>
                    </div>
                </div>
            </div>`;

            cardList.append(cardHTML);

            let colorOptionsDiv = $(`#color-options-${card.id}`);
            card.versions.forEach((version, index) => {
                const color = window.colorMap[version.color] ?? "#000000";
                colorOptionsDiv.append(`
                <div class="form-check">
                    <input 
                        class="form-check-input" 
                        id="color-${card.id}-${version.color}" 
                        type="radio" 
                        name="color-${card.id}" 
                        style="cursor: pointer; background-color: ${color};" 
                        data-bs-toggle="tooltip" 
                        data-bs-placement="bottom" 
                        title="${version.color}" 
                        value="${version.color}" 
                        data-img="${version.img_path}" 
                        ${index === 0 ? "checked" : ""}
                    >
                </div>
            `);
            });

            // Xử lý sự kiện thay đổi màu sắc
            $(`input[name="color-${card.id}"]`).change(function () {
                $(`#product-image-${card.id}`).attr("src", $(this).data("img"));
                $(`input[name="color-${card.id}"]`).tooltip('hide');
            });

            // Khởi tạo tooltip
            $('[data-bs-toggle="tooltip"]').tooltip();
        });

        // Khởi tạo Owl Carousel sau khi thêm tất cả các items
        cardList.owlCarousel({
            loop: true,
            margin: 10,
            dots: false,
            nav: true,
            responsive: {
                0: {
                    items: 1
                },
                600: {
                    items: 2
                },
                1000: {
                    items: 4
                }
            }
        });
        // Tùy chỉnh màu sắc nút điều hướng sau khi Owl Carousel đã khởi tạo
        $(".owl-prev, .owl-next").css({
            "background-color": "white",  // Màu nền nút
            "color": "black",               // Màu chữ
            "border-radius": "50%",         // Hình tròn
            "padding": "10px",              // Khoảng cách
            "font-size": "18px"             // Kích thước chữ
        });

        // Thêm hiệu ứng hover cho các nút điều hướng
        $(".owl-prev, .owl-next").hover(
            function () {
                $(this).css("background-color", "black");  // Màu nền khi hover
            },
            function () {
                $(this).css("background-color", "white");  // Màu nền khi rời hover
            }
        );
    }

    function calcScrollValue() {
        let pos = $(document).scrollTop() //Vị trí hiện tại
        let calcHeight = $(document).height() - $(window).height();
        let scrollValue = Math.round((pos / calcHeight) * 100); // tỷ lệ % vị trí hiện tại so với tài liệu

        if (pos > 100) {
            $("#progress").fadeIn()
        }
        else {
            $("#progress").fadeOut()
        }
        $("#progress").css("background", `conic-gradient( #001a2e ${scrollValue}%, #f8f9fa ${scrollValue}%)`)
    }

    $(window).on("scroll", calcScrollValue);
    $(window).on("load", calcScrollValue);
    function zoom() {
        $("#card-list img, .card-list img").hover(
            function () {
                $(this).css({
                    "transform": "scale(1.2)",
                    "transition": "2s ease"
                })
            }, function () {
                $(this).css({
                    "transform": "scale(1)",
                    "transition": "0.5s ease"
                })
            })
    }
</script>

<body>
    <div id="wrapper" class="text-dark">
        <header></header>
        <div class="container" style="margin-top: 6rem;">
            <a href="./index.html">Trang chủ</a>
            <a><i class="bi bi-chevron-right"></i></a>
            <a href="">Phụ nữ</a>
            <a><i class="bi bi-chevron-right"></i></a>
            <a href="">Áo Sweater</a>
        </div>
        <!--Flat title-->
        <div class="container mb-5">
            <div class="flat-title text-center">
                <h1>Mọi người khác cũng thích</h1>
                <p>Mua sắm những phong cách mới nhất: Luôn dẫn đầu xu hướng với những sản phẩm mới nhất của chúng tôi
                </p>
            </div>
        </div>
        <main class="my-2">
            <div class="container">
                <div class="row">
                    <div class="detail-img col-xl-6 col-md-6 col-12">
                        <div id="carouselExample" class="carousel slide">
                            <div class="carousel-inner">
                                <div class="carousel-item active">
                                    <img src="./assets/images/detail/beige-2.jpg" class="d-block w-100" alt="img">
                                </div>
                                <div class="carousel-item">
                                    <img src="./assets/images/detail/beige-3.jpg" class="d-block w-100" alt="img">
                                </div>
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample"
                                data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselExample"
                                data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    </div>
                    <div class="detail-content col-xl-6 col-md-6 col-12">
                        <h3>Áo thun cotton jersey</h3>
                        <span class="p-2 border border-1 border-black rounded-1 fw-bolder" style="font-size: 10px;">Bán
                            chạy nhất</span>
                        <span id="lightning"><i class="bi bi-lightning-charge-fill"></i></span>
                        <span class="fw-bold">Bán chạy quá! Đã có 56 người mua sản phẩm này trong giỏ hàng.</span>
                        <div class="d-flex my-2 gap-2 align-items-center">
                            <h3 class="m-0">149,000₫</h3>
                            <h4 class="m-0">189,000₫</h4>
                            <div class="badge text-bg-light p-1">Giảm 20%</div>
                        </div>
                        <div class="d-flex gap-2 my-4 align-items-center">
                            <div class="badge text-bg-danger p-2">50</div>
                            <h6 class="fw-bold m-0">Người đang xem lúc này</h6>
                        </div>
                        <div class="p-2 border border-1 border-black rounded-1 fw-bolder d-inline-flex">
                            <div style=" padding: 10px 15px;">
                                <div style="font-size: 10px;"><i class="bi-alarm me-2"></i>NHANH LÊN! KHUYẾN MẠI KẾT
                                    THÚC
                                    SAU:</div>
                                <div id="countdown" style="font-size: 16px;">24:00:00</div>
                            </div>
                        </div>
                        <div class="mt-2">
                            <h6>Màu sắc <b>Màu be</b></h6>
                        </div>
                        <div class="form-check d-flex align-items-center">
                            <input class="form-check-input" id="beige" type="radio"
                                style="cursor: pointer; background-color: beige;" data-bs-toggle="tooltip"
                                data-bs-placement="bottom" title="Beige" value="beige">
                            <div class="mb-0 ms-2">Màu be</div>
                        </div>

                        <div class="form-check d-flex align-items-center">
                            <input class="form-check-input" id="beige" type="radio"
                                style="cursor: pointer; background-color: beige;" data-bs-toggle="tooltip"
                                data-bs-placement="bottom" title="Beige" value="beige">
                            <div class="mb-0 ms-2">Màu be</div>
                        </div>
                        <div class="form-check d-flex align-items-center">
                            <input class="form-check-input" id="beige" type="radio"
                                style="cursor: pointer; background-color: beige;" data-bs-toggle="tooltip"
                                data-bs-placement="bottom" title="Beige" value="beige">
                            <div class="mb-0 ms-2">Màu be</div>
                        </div>

                    </div>
                </div>
            </div>
        </main>
        <section id="best-seller" class="mt-5">
            <div class="container">
                <div class="row" id="card-list">
                </div>
            </div>
        </section>
        <footer class="mx-3 my-5"></footer>
        <hr>
        <div class="footer-bottom my-4"></div>
        <div id="progress">
            <span id="progress-value"><i class="bi bi-chevron-up"></i></span>
        </div>
    </div>
    <script src="./assets/js/bootstrap.bundle.min.js"></script>
    <script src="./assets/js/owl.carousel.min.js"></script>
    <script src="./assets/js/script.js"></script>
</body>

</html>